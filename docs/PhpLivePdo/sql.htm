<html>
  <head>
    <title>PhpLivePdo - SQL</title>
    <link rel="stylesheet" href="files/global.css">
    <style>
      .menu{
        border-bottom: dotted 1px #ccc;
      }
      .menulink{
        color: #ccc;
      }
      .color1{
        color: #793862;
      }
      .color2{
        color: #369;
      }
      .color3{
        color: #693;
      }
      .color4{
        color: #d00;
      }
      .color5{
        color: #FF8000;
      }
    </style>
  </head>
  <body style="background-color: #333; font-family: 'Fira Sans', 'Source Sans Pro', Helvetica, Arial, sans-serif;">
    <table style="width:88%;margin-left: auto;margin-right: auto;">
      <tr>
        <td style="background-color: #F2F2F2; padding: 20px;">
          <div style="font-size: 22px; border-bottom: dotted 1px;" class="color1">
            <strong>PhpLivePdo::SQL</strong>
          </div>
          <p>Send a query to run in database</p>
          <p>&nbsp;</p>

          <div style="font-size: 18px; border-bottom: dotted 1px;" class="color1">
            <strong>Sintaxe</strong>
          </div>
          <br>
          <div style="background-color: #fff; padding: 10px; border: dotted 1px;">
            <strong>
              <span class="color1">public</span> <span class="color2">PhpLivePdo::SQL</span> ( 
              <span class="color3">string</span> <span class="color2">$Query</span>[,
              <span class="color3">array</span> <span class="color2">$Params</span>[,
              <span class="color3">array</span> <span class="color2">$Options</span>
              ] ] );
            </strong>
          </div>
          <p>&nbsp;</p>

          <div style="font-size: 18px; border-bottom: dotted 1px;" class="color1">
            <strong>Parameters</strong>
          </div>
          <p><strong class="color2">$Query</strong></p>
          <p>The query to be executed</p>
          <p><strong class="color2">$Params</strong></p>
          <p>A array with the tokens to be replaced:</p>
          <div style="background-color: #fff; padding: 10px; border: dotted 1px;">
            <strong>
              [TokenName, TokenData, TokenType]
            </strong>
          </div>
          <p>TokenName can be a number or a string like starting with ":";</p>
          <p>TokenData its the value to be replaced;</p>
          <p>TokenType can be the constants of <span class="color2">PhpLivePdo</span> (<span class="color2">PdoInt</span>, <span class="color2">PdoStr</span>, <span class="color2">PdoNull</span>, <span class="color2">PdoBool</span>) or the <a href="https://www.php.net/manual/pt_BR/pdo.constants.php" target="_blank">constants of PDO</a>;</p>

          <p><strong>List of <span class="color2">$Options</span>:</strong></p>
          <p>&nbsp;&nbsp;Safe (Boolean)(Optional - Default: true) - Dont run query update or delete without where condition or the query truncate;</p>
          <p>&nbsp;&nbsp;Debug (Boolean)(Optional - Default: false) - Dump the query after parsed;</p>
          <p>&nbsp;&nbsp;Log (Integer)(Optional) - The log description of the event;</p>
          <p>&nbsp;&nbsp;User (Integer)(Optional - Mandatory with Log) - The user running the query;</p>
          <p>&nbsp;&nbsp;Target (Integer)(Optional - Optional with Log) - The user afected by the query;</p>
          <p>&nbsp;</p>

          <div style="font-size: 18px; border-bottom: dotted 1px;" class="color1">
            <strong>Return Values</strong>
          </div>
          <p>Return an integer in case of insert, update and delete, an array in case of select, or <strong>FALSE</strong> in case of error in <span class="color2">PhpLivePdo</span>;</p>
          <p>&nbsp;</p>

          <div style="font-size: 18px; border-bottom: dotted 1px;" class="color1">
            <strong>Examples</strong>
          </div>
          <br>
          <p><strong>A simple query:</strong></p>
          <div style="background-color: #fff; padding: 10px; border: dotted 1px;">
            <strong>
              <span class="color2">$result</span> = <span class="color2">$PDO->SQL</span>(<span class="color4">"select * from users"</span>);
            </strong>
          </div>
          <p><strong>A query with ordened tokens:</strong></p>
          <div style="background-color: #fff; padding: 10px; border: dotted 1px;">
            <strong>
              <span class="color2">$result</span> = <span class="color2">$PDO->SQL</span>(<span class="color4">"select * from users where email=? and city=?"</span>, [<br>
                &nbsp;&nbsp;&nbsp;[<span class="color2">1</span>, <span class="color2">$_POST[<span class="color4">"email"</span>]</span>, <span class="color2">PdoStr</span>],<br>
                &nbsp;&nbsp;&nbsp;[<span class="color2">2</span>, <span class="color2">$_POST[<span class="color4">"city"</span>]</span>, <span class="color2">PdoInt</span>]<br>
              ]);
            </strong>
          </div>
          <p><strong>A query with named tokens:</strong></p>
          <div style="background-color: #fff; padding: 10px; border: dotted 1px;">
            <strong>
              <span class="color2">$result</span> = <span class="color2">$PDO->SQL</span>(<span class="color4">"select * from users where name like :name or city like :name"</span>, [<br>
                &nbsp;&nbsp;&nbsp;[<span class="color4">":name"</span>, <span class="color4">"%"</span> . <span class="color2">$_POST[<span class="color4">"name"</span>]</span> . <span class="color4">"%"</span>, <span class="color2">PdoStr</span>],<br>
              ]);
            </strong>
          </div>
          <p><strong>A simple query with table prefix:</strong></p>
          <div style="background-color: #fff; padding: 10px; border: dotted 1px;">
            <strong>
              <span class="color2">$result</span> = <span class="color2">$PDO->SQL</span>(<span class="color4">"select * from ##users"</span>);<br>
              <span class="color5">// Execute the query: select * from sys_users</span>
            </strong>
          </div>
          <br>
          
          <p><strong>Getting the values returned:</strong></p>
          <div style="background-color: #fff; padding: 10px; border: dotted 1px;">
            <strong>
              <span class="color2">$result</span> = <span class="color2">$PDO->SQL</span>(<span class="color4">"select * from ##users"</span>);<br>
              <span class="color3">echo</span> <span class="color4">"Welcome "</span> . <span class="color2">$result</span>[<span class="color2">0</span>][<span class="color4">"name"</span>];
            </strong>
          </div>
          <p><strong>Getting the values returned:</strong></p>
          <div style="background-color: #fff; padding: 10px; border: dotted 1px;">
            <strong>
              <span class="color2">$result</span> = <span class="color2">$PDO->SQL</span>(<span class="color4">"select * from ##users"</span>);<br>
              <span class="color3">foreach</span>(<span class="color2">$result</span> <span class="color3">as</span> <span class="color2">$line</span>){<br>
                &nbsp;&nbsp;&nbsp;<span class="color3">echo</span> <span class="color2">$line</span>[<span class="color4">"name"</span>] . <span class="color4">"&lt;br>"</span>;<br>
              }
            </strong>
          </div>
          <p><strong>Debbuging a query:</strong></p>
          <div style="background-color: #fff; padding: 10px; border: dotted 1px;">
            <strong>
              <span class="color2">$result</span> = <span class="color2">$PDO->SQL</span>(<span class="color4">"select * from users where email=? and city=?"</span>,<br>
                &nbsp;&nbsp;&nbsp;[<br>
                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="color2">1</span>, <span class="color2">$_POST</span>[<span class="color4">"email"</span>], <span class="color2">PdoStr</span>],<br>
                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="color2">2</span>, <span class="color2">$_POST</span>[<span class="color4">"city"</span>], <span class="color2">PdoInt</span>]<br>
                &nbsp;&nbsp;&nbsp;], [<br>
                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="color4">"Debug"</span> => <span class="color2">true</span><br>
                &nbsp;&nbsp;&nbsp;]<br>
              );
            </strong>
          </div>
          <p>&nbsp;</p>

        </td>
        <td style="width:300px; color: #ccc; font-size: 18px; vertical-align: top;">
          PhpLivePdo functions
          <table style="width:100%">
            <tr><td class="menu"><a href="index.html" class="menulink">__construct</a></td></tr>
            <tr><td class="menu"><a href="sql.htm" class="menulink">SQL</a></td></tr>
            <tr><td class="menu"><a href="insert.htm" class="menulink">SqlInsert</a></td></tr>
            <tr><td class="menu"><a href="update.htm" class="menulink">SqlUpdate</a></td></tr>
          </table>
        </td>
      </tr>
    </table>
  </body>
</html>